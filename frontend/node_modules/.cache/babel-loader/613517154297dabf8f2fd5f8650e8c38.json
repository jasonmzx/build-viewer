{"ast":null,"code":"import _classCallCheck from \"C:/Users/jason/Documents/GitHub/build-viewer/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"C:/Users/jason/Documents/GitHub/build-viewer/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _get from \"C:/Users/jason/Documents/GitHub/build-viewer/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/get.js\";\nimport _getPrototypeOf from \"C:/Users/jason/Documents/GitHub/build-viewer/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js\";\nimport _inherits from \"C:/Users/jason/Documents/GitHub/build-viewer/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"C:/Users/jason/Documents/GitHub/build-viewer/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\nimport TempNode from '../core/TempNode.js';\n\nvar OperatorNode = /*#__PURE__*/function (_TempNode) {\n  _inherits(OperatorNode, _TempNode);\n\n  var _super = _createSuper(OperatorNode);\n\n  function OperatorNode(op, aNode, bNode) {\n    var _this;\n\n    _classCallCheck(this, OperatorNode);\n\n    _this = _super.call(this);\n    _this.op = op;\n\n    if ((arguments.length <= 3 ? 0 : arguments.length - 3) > 0) {\n      var finalBNode = bNode;\n\n      for (var i = 0; i < (arguments.length <= 3 ? 0 : arguments.length - 3); i++) {\n        finalBNode = new OperatorNode(op, finalBNode, i + 3 < 3 || arguments.length <= i + 3 ? undefined : arguments[i + 3]);\n      }\n\n      bNode = finalBNode;\n    }\n\n    _this.aNode = aNode;\n    _this.bNode = bNode;\n    return _this;\n  }\n\n  _createClass(OperatorNode, [{\n    key: \"getNodeType\",\n    value: function getNodeType(builder, output) {\n      var op = this.op;\n      var aNode = this.aNode;\n      var bNode = this.bNode;\n      var typeA = aNode.getNodeType(builder);\n      var typeB = bNode.getNodeType(builder);\n\n      if (typeA === 'void' || typeB === 'void') {\n        return 'void';\n      } else if (op === '=' || op === '%') {\n        return typeA;\n      } else if (op === '&' || op === '|' || op === '^' || op === '>>' || op === '<<') {\n        return 'int';\n      } else if (op === '==' || op === '&&' || op === '||' || op === '^^') {\n        return 'bool';\n      } else if (op === '<' || op === '>' || op === '<=' || op === '>=') {\n        var typeLength = builder.getTypeLength(output);\n        return typeLength > 1 ? \"bvec\".concat(typeLength) : 'bool';\n      } else {\n        if (typeA === 'float' && builder.isMatrix(typeB)) {\n          return typeB;\n        } else if (builder.isMatrix(typeA) && builder.isVector(typeB)) {\n          // matrix x vector\n          return builder.getVectorFromMatrix(typeA);\n        } else if (builder.isVector(typeA) && builder.isMatrix(typeB)) {\n          // vector x matrix\n          return builder.getVectorFromMatrix(typeB);\n        } else if (builder.getTypeLength(typeB) > builder.getTypeLength(typeA)) {\n          // anytype x anytype: use the greater length vector\n          return typeB;\n        }\n\n        return typeA;\n      }\n    }\n  }, {\n    key: \"generate\",\n    value: function generate(builder, output) {\n      var op = this.op;\n      var aNode = this.aNode;\n      var bNode = this.bNode;\n      var type = this.getNodeType(builder, output);\n      var typeA = null;\n      var typeB = null;\n\n      if (type !== 'void') {\n        typeA = aNode.getNodeType(builder);\n        typeB = bNode.getNodeType(builder);\n\n        if (op === '=') {\n          typeB = typeA;\n        } else if (op === '<' || op === '>' || op === '<=' || op === '>=') {\n          if (builder.isVector(typeA)) {\n            typeB = typeA;\n          } else {\n            typeA = typeB = 'float';\n          }\n        } else if (builder.isMatrix(typeA) && builder.isVector(typeB)) {\n          // matrix x vector\n          typeB = builder.getVectorFromMatrix(typeA);\n        } else if (builder.isVector(typeA) && builder.isMatrix(typeB)) {\n          // vector x matrix\n          typeA = builder.getVectorFromMatrix(typeB);\n        } else {\n          // anytype x anytype\n          typeA = typeB = type;\n        }\n      } else {\n        typeA = typeB = type;\n      }\n\n      var a = aNode.build(builder, typeA);\n      var b = bNode.build(builder, typeB);\n      var outputLength = builder.getTypeLength(output);\n\n      if (output !== 'void') {\n        if (op === '=') {\n          builder.addFlowCode(\"\".concat(a, \" \").concat(this.op, \" \").concat(b));\n          return a;\n        } else if (op === '>' && outputLength > 1) {\n          return builder.format(\"\".concat(builder.getMethod('greaterThan'), \"( \").concat(a, \", \").concat(b, \" )\"), type, output);\n        } else if (op === '<=' && outputLength > 1) {\n          return builder.format(\"\".concat(builder.getMethod('lessThanEqual'), \"( \").concat(a, \", \").concat(b, \" )\"), type, output);\n        } else {\n          return builder.format(\"( \".concat(a, \" \").concat(this.op, \" \").concat(b, \" )\"), type, output);\n        }\n      } else if (typeA !== 'void') {\n        return builder.format(\"\".concat(a, \" \").concat(this.op, \" \").concat(b), type, output);\n      }\n    }\n  }, {\n    key: \"serialize\",\n    value: function serialize(data) {\n      _get(_getPrototypeOf(OperatorNode.prototype), \"serialize\", this).call(this, data);\n\n      data.op = this.op;\n    }\n  }, {\n    key: \"deserialize\",\n    value: function deserialize(data) {\n      _get(_getPrototypeOf(OperatorNode.prototype), \"deserialize\", this).call(this, data);\n\n      this.op = data.op;\n    }\n  }]);\n\n  return OperatorNode;\n}(TempNode);\n\nexport default OperatorNode;","map":{"version":3,"sources":["C:/Users/jason/Documents/GitHub/build-viewer/frontend/node_modules/three-stdlib/nodes/math/OperatorNode.js"],"names":["TempNode","OperatorNode","op","aNode","bNode","finalBNode","i","builder","output","typeA","getNodeType","typeB","typeLength","getTypeLength","isMatrix","isVector","getVectorFromMatrix","type","a","build","b","outputLength","addFlowCode","format","getMethod","data"],"mappings":"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","sourcesContent":["import TempNode from '../core/TempNode.js';\n\nclass OperatorNode extends TempNode {\n  constructor(op, aNode, bNode, ...params) {\n    super();\n    this.op = op;\n\n    if (params.length > 0) {\n      let finalBNode = bNode;\n\n      for (let i = 0; i < params.length; i++) {\n        finalBNode = new OperatorNode(op, finalBNode, params[i]);\n      }\n\n      bNode = finalBNode;\n    }\n\n    this.aNode = aNode;\n    this.bNode = bNode;\n  }\n\n  getNodeType(builder, output) {\n    const op = this.op;\n    const aNode = this.aNode;\n    const bNode = this.bNode;\n    const typeA = aNode.getNodeType(builder);\n    const typeB = bNode.getNodeType(builder);\n\n    if (typeA === 'void' || typeB === 'void') {\n      return 'void';\n    } else if (op === '=' || op === '%') {\n      return typeA;\n    } else if (op === '&' || op === '|' || op === '^' || op === '>>' || op === '<<') {\n      return 'int';\n    } else if (op === '==' || op === '&&' || op === '||' || op === '^^') {\n      return 'bool';\n    } else if (op === '<' || op === '>' || op === '<=' || op === '>=') {\n      const typeLength = builder.getTypeLength(output);\n      return typeLength > 1 ? `bvec${typeLength}` : 'bool';\n    } else {\n      if (typeA === 'float' && builder.isMatrix(typeB)) {\n        return typeB;\n      } else if (builder.isMatrix(typeA) && builder.isVector(typeB)) {\n        // matrix x vector\n        return builder.getVectorFromMatrix(typeA);\n      } else if (builder.isVector(typeA) && builder.isMatrix(typeB)) {\n        // vector x matrix\n        return builder.getVectorFromMatrix(typeB);\n      } else if (builder.getTypeLength(typeB) > builder.getTypeLength(typeA)) {\n        // anytype x anytype: use the greater length vector\n        return typeB;\n      }\n\n      return typeA;\n    }\n  }\n\n  generate(builder, output) {\n    const op = this.op;\n    const aNode = this.aNode;\n    const bNode = this.bNode;\n    const type = this.getNodeType(builder, output);\n    let typeA = null;\n    let typeB = null;\n\n    if (type !== 'void') {\n      typeA = aNode.getNodeType(builder);\n      typeB = bNode.getNodeType(builder);\n\n      if (op === '=') {\n        typeB = typeA;\n      } else if (op === '<' || op === '>' || op === '<=' || op === '>=') {\n        if (builder.isVector(typeA)) {\n          typeB = typeA;\n        } else {\n          typeA = typeB = 'float';\n        }\n      } else if (builder.isMatrix(typeA) && builder.isVector(typeB)) {\n        // matrix x vector\n        typeB = builder.getVectorFromMatrix(typeA);\n      } else if (builder.isVector(typeA) && builder.isMatrix(typeB)) {\n        // vector x matrix\n        typeA = builder.getVectorFromMatrix(typeB);\n      } else {\n        // anytype x anytype\n        typeA = typeB = type;\n      }\n    } else {\n      typeA = typeB = type;\n    }\n\n    const a = aNode.build(builder, typeA);\n    const b = bNode.build(builder, typeB);\n    const outputLength = builder.getTypeLength(output);\n\n    if (output !== 'void') {\n      if (op === '=') {\n        builder.addFlowCode(`${a} ${this.op} ${b}`);\n        return a;\n      } else if (op === '>' && outputLength > 1) {\n        return builder.format(`${builder.getMethod('greaterThan')}( ${a}, ${b} )`, type, output);\n      } else if (op === '<=' && outputLength > 1) {\n        return builder.format(`${builder.getMethod('lessThanEqual')}( ${a}, ${b} )`, type, output);\n      } else {\n        return builder.format(`( ${a} ${this.op} ${b} )`, type, output);\n      }\n    } else if (typeA !== 'void') {\n      return builder.format(`${a} ${this.op} ${b}`, type, output);\n    }\n  }\n\n  serialize(data) {\n    super.serialize(data);\n    data.op = this.op;\n  }\n\n  deserialize(data) {\n    super.deserialize(data);\n    this.op = data.op;\n  }\n\n}\n\nexport default OperatorNode;\n"]},"metadata":{},"sourceType":"module"}