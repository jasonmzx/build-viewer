{"ast":null,"code":"import _createForOfIteratorHelper from \"C:/Users/jason/Documents/GitHub/build-viewer/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";\nimport _slicedToArray from \"C:/Users/jason/Documents/GitHub/build-viewer/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\jason\\\\Documents\\\\GitHub\\\\build-viewer\\\\frontend\\\\src\\\\components\\\\Upload.js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport React from 'react';\nimport { Container } from \"react-bootstrap\";\nimport NavbarToggle from 'react-bootstrap/esm/NavbarToggle';\nimport nbt from '../nbt';\nimport View from './View';\nimport TexturePlane from './TexturePlane';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar Upload = function Upload() {\n  _s();\n\n  var _React$useState = React.useState([]),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      scene = _React$useState2[0],\n      setScene = _React$useState2[1];\n\n  var _React$useState3 = React.useState({\n    'planes': []\n  }),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      planeList = _React$useState4[0],\n      setPlanes = _React$useState4[1]; // handleUpload = (event) => {\n  //     console.log('Success!');\n  // }\n\n\n  function renderHandler() {\n    console.log('[RENDER] calling...');\n    console.log(scene);\n\n    if (scene.length == 0) {\n      console.log('[RENDER] Denied!');\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        children: \"Nothing is rendered..\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 25,\n        columnNumber: 11\n      }, this);\n    } else {\n      console.log('[RENDER] Working...');\n      console.log('[RENDER] Received planes:');\n      return /*#__PURE__*/_jsxDEV(View, {\n        top: scene\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 34,\n        columnNumber: 11\n      }, this);\n    }\n  }\n\n  function blockStructure(palette, pValue) {\n    var BlockType = palette[pValue];\n\n    if (BlockType.Name.value == 'minecraft:air') {\n      return {\n        'name': '',\n        'cube': false\n      };\n    }\n\n    if (BlockType.Properties) {\n      return {\n        'name': BlockType.Name.value,\n        'cube': false,\n        'special': BlockType.Properties.value\n      };\n    } else {\n      return {\n        'name': BlockType.Name.value,\n        'cube': true\n      };\n    }\n  }\n\n  function findBlock(x, y, z, data, palette) {\n    //console.log(data[0].pos.value.value);\n    var _iterator = _createForOfIteratorHelper(data.entries()),\n        _step;\n\n    try {\n      for (_iterator.s(); !(_step = _iterator.n()).done;) {\n        var _step$value = _slicedToArray(_step.value, 2),\n            i = _step$value[0],\n            v = _step$value[1];\n\n        var BlockArray = data[i].pos.value.value;\n\n        if (BlockArray[0] == x && BlockArray[1] == y && BlockArray[2] == z) {\n          return blockStructure(palette, data[i].state.value);\n        }\n      }\n    } catch (err) {\n      _iterator.e(err);\n    } finally {\n      _iterator.f();\n    }\n  }\n\n  function parseNBT(input) {\n    console.log('Parsing...');\n    var dump = {\n      author: \"\",\n      dimension: {\n        x: 0,\n        y: 0,\n        z: 0\n      },\n      blocks: [] //blocks[x][y][z]\n\n    }; // const BlockList = input.value.blocks.value.value;\n    // BlockPositionArray = input.value.blocks.value.value.pos.value.value;\n    //Block palette:\n\n    var palette = input.value.palette.value.value;\n    console.log(palette); //First Pass\n\n    var _iterator2 = _createForOfIteratorHelper(input.value.blocks.value.value),\n        _step2;\n\n    try {\n      for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n        var block = _step2.value;\n        console.log(block); //The [ x, y, z ] Array\n\n        var blockArray = block.pos.value.value;\n\n        if (blockArray[0] > dump.dimension.x) {\n          dump.dimension.x = blockArray[0];\n        } //y\n\n\n        if (blockArray[1] > dump.dimension.y) {\n          dump.dimension.y = blockArray[1];\n        } //z\n\n\n        if (blockArray[2] > dump.dimension.z) {\n          dump.dimension.z = blockArray[2];\n        }\n      }\n    } catch (err) {\n      _iterator2.e(err);\n    } finally {\n      _iterator2.f();\n    }\n\n    dump.dimension.x++;\n    dump.dimension.y++;\n    dump.dimension.z++; //( +1 to each axis after loop )\n\n    console.log(dump.dimension); //Generating 3d Array Structure: \n\n    for (var x_i = 0; x_i < dump.dimension.x; x_i++) {\n      //Generate all x indexes\n      dump.blocks.push([]); //Generate all y indexes within x indexes\n\n      for (var y_i = 0; y_i < dump.dimension.y; y_i++) {\n        dump.blocks[x_i].push([]); //Generate z indexes within y indexes\n\n        for (var z_i = 0; z_i < dump.dimension.z; z_i++) {\n          dump.blocks[x_i][y_i].push(findBlock(x_i, y_i, z_i, input.value.blocks.value.value, palette));\n          console.log('generating 3d arr');\n        }\n      }\n    }\n\n    console.log(' 3D structure: ');\n    console.log(dump.blocks);\n    var sceneParse = []; //Generate planes:\n\n    var _iterator3 = _createForOfIteratorHelper(dump.blocks.entries()),\n        _step3;\n\n    try {\n      for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n        var _step3$value = _slicedToArray(_step3.value, 2),\n            xIter = _step3$value[0],\n            xVal = _step3$value[1];\n\n        console.log(xIter); //Console logs all x arrays\n\n        var _iterator4 = _createForOfIteratorHelper(xVal.entries()),\n            _step4;\n\n        try {\n          for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {\n            var _step4$value = _slicedToArray(_step4.value, 2),\n                yIter = _step4$value[0],\n                yVal = _step4$value[1];\n\n            console.log(yIter);\n\n            var _iterator5 = _createForOfIteratorHelper(yVal.entries()),\n                _step5;\n\n            try {\n              for (_iterator5.s(); !(_step5 = _iterator5.n()).done;) {\n                var _step5$value = _slicedToArray(_step5.value, 2),\n                    zIter = _step5$value[0],\n                    zVal = _step5$value[1];\n\n                console.log(zVal); //This will be the logic for rendering:\n                //Surrounding block coord differences: xyz 012\n\n                var surround = [[0, 1], [0, -1], [1, 1], [1, -1], [2, 1], [2, -1]];\n                console.log('viewing: ');\n                console.log(zVal.name + \"@\" + xIter + ' ' + yIter + ' ' + zIter);\n\n                if (!zVal.name) {\n                  continue;\n                }\n\n                for (var k = 0; k < surround.length; k++) {\n                  //do something\n                  if (surround[k][0] == 0) {\n                    //Looking at x\n                    var compare = '';\n\n                    try {\n                      compare = dump.blocks[xIter + surround[k][1]][yIter][zIter];\n                    } catch (error) {\n                      console.log('Render NULL X');\n                    }\n\n                    if (!compare || compare.cube == false) {\n                      //Render for x\n                      // blockState.push(\n                      //   <TexturePlane x={xIter} y={yIter} z={zIter} rot={[0, Math.PI / 2, 0]}/>\n                      // );\n                      // console.log('Rendering x @'+surround[k][1]+ ' x'+xIter+' y'+yIter+' z'+zIter);\n                      sceneParse.push(surround[k][1] > 0 ? /*#__PURE__*/_jsxDEV(TexturePlane, {\n                        x: xIter - 1,\n                        y: yIter + 0.5,\n                        z: zIter,\n                        rot: [0, -Math.PI / 2, 0]\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 186,\n                        columnNumber: 19\n                      }, this) : /*#__PURE__*/_jsxDEV(TexturePlane, {\n                        x: xIter,\n                        y: yIter + 0.5,\n                        z: zIter,\n                        rot: [0, Math.PI / 2, 0]\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 187,\n                        columnNumber: 21\n                      }, this));\n                    }\n                  }\n\n                  if (surround[k][0] == 1) {\n                    var _compare = '';\n\n                    try {\n                      _compare = dump.blocks[xIter][yIter + surround[k][1]][zIter];\n                    } catch (error) {\n                      console.log('Render NULL Y');\n                    }\n\n                    if (!_compare || _compare.cube == false) {\n                      sceneParse.push(surround[k][1] > 0 ? /*#__PURE__*/_jsxDEV(TexturePlane, {\n                        x: xIter - 0.5,\n                        y: yIter + 0.5,\n                        z: zIter - 0.5,\n                        rot: [0, 0, -Math.PI / 2]\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 203,\n                        columnNumber: 19\n                      }, this) : /*#__PURE__*/_jsxDEV(TexturePlane, {\n                        x: xIter - 0.5,\n                        y: yIter + 0.5,\n                        z: zIter + 0.5,\n                        rot: [0, 0, Math.PI / 2]\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 204,\n                        columnNumber: 21\n                      }, this));\n                    }\n                  }\n\n                  if (surround[k][0] == 2) {\n                    var _compare2 = '';\n\n                    try {\n                      _compare2 = dump.blocks[xIter][yIter][zIter + surround[k][1]];\n                    } catch (error) {\n                      console.log('Render NULL Z');\n                    }\n\n                    if (!_compare2 || _compare2.cube == false) {\n                      sceneParse.push(surround[k][1] > 0 ? /*#__PURE__*/_jsxDEV(TexturePlane, {\n                        x: xIter - 0.5,\n                        y: yIter + 1,\n                        z: zIter,\n                        rot: [Math.PI / 2, 0, 0]\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 221,\n                        columnNumber: 19\n                      }, this) : /*#__PURE__*/_jsxDEV(TexturePlane, {\n                        x: xIter - 0.5,\n                        y: yIter,\n                        z: zIter,\n                        rot: [-Math.PI / 2, 0, 0]\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 222,\n                        columnNumber: 21\n                      }, this));\n                    }\n                  }\n                }\n              } // end of z loop\n\n            } catch (err) {\n              _iterator5.e(err);\n            } finally {\n              _iterator5.f();\n            }\n          }\n        } catch (err) {\n          _iterator4.e(err);\n        } finally {\n          _iterator4.f();\n        }\n      }\n    } catch (err) {\n      _iterator3.e(err);\n    } finally {\n      _iterator3.f();\n    }\n\n    console.log('# of Planes:');\n    console.log(sceneParse.length);\n    console.log('\\n');\n    setScene(sceneParse); // for(const block of input.value.blocks.value.value){\n    //   console.log(block.pos.value.value);\n    //   console.log(block.state.value);\n    // }\n    //setScene([<TexturePlane x={3} y={3} z={0} rot={[-Math.PI / 2, 0, 0]}/>]);\n  }\n\n  function handleChange(event) {\n    console.log(event.target.files); // console.log(event.target.files[0]); //file struc\n\n    var file = event.target.files[0];\n    var reader = new FileReader();\n\n    reader.onload = function (e) {\n      console.log(e.target.result);\n      var x = nbt.parse(e.target.result, function (error, data) {\n        if (error) {\n          throw error;\n        }\n\n        console.log(data);\n        parseNBT(data);\n      });\n    };\n\n    reader.readAsArrayBuffer(file);\n  }\n\n  return /*#__PURE__*/_jsxDEV(Container, {\n    children: [\"Input NBT file \", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 278,\n      columnNumber: 20\n    }, _this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"file\",\n      onChange: handleChange\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 279,\n      columnNumber: 5\n    }, _this), renderHandler()]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 277,\n    columnNumber: 5\n  }, _this);\n};\n\n_s(Upload, \"Ph8qPJoWhJdHPVaAx2l5tb5Uuyw=\");\n\n_c = Upload;\nexport default Upload;\n\nvar _c;\n\n$RefreshReg$(_c, \"Upload\");","map":{"version":3,"sources":["C:/Users/jason/Documents/GitHub/build-viewer/frontend/src/components/Upload.js"],"names":["React","Container","NavbarToggle","nbt","View","TexturePlane","Upload","useState","scene","setScene","planeList","setPlanes","renderHandler","console","log","length","blockStructure","palette","pValue","BlockType","Name","value","Properties","findBlock","x","y","z","data","entries","i","v","BlockArray","pos","state","parseNBT","input","dump","author","dimension","blocks","block","blockArray","x_i","push","y_i","z_i","sceneParse","xIter","xVal","yIter","yVal","zIter","zVal","surround","name","k","compare","error","cube","Math","PI","handleChange","event","target","files","file","reader","FileReader","onload","e","result","parse","readAsArrayBuffer"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport {Container} from \"react-bootstrap\";\r\nimport NavbarToggle from 'react-bootstrap/esm/NavbarToggle';\r\nimport nbt from '../nbt';\r\nimport View from './View';\r\nimport TexturePlane from './TexturePlane';\r\n\r\nconst Upload = () => {\r\n    const [scene , setScene] = React.useState([]);\r\n    const [planeList, setPlanes] = React.useState({\r\n      'planes' : []\r\n    });\r\n\r\n    // handleUpload = (event) => {\r\n    //     console.log('Success!');\r\n    // }\r\n\r\n    function renderHandler(){\r\n      console.log('[RENDER] calling...')\r\n      console.log(scene);\r\n\r\n      if(scene.length == 0){\r\n        console.log('[RENDER] Denied!')\r\n        return(\r\n          <div>\r\n            Nothing is rendered..\r\n          </div>\r\n        )\r\n      } else {\r\n        console.log('[RENDER] Working...')\r\n        console.log('[RENDER] Received planes:');\r\n\r\n        return (\r\n          <View top={scene}/>\r\n        )\r\n      }\r\n    }\r\n\r\n\r\n    function blockStructure(palette, pValue){\r\n      const BlockType = palette[pValue];\r\n\r\n      if(BlockType.Name.value == 'minecraft:air'){\r\n        return {'name' : '', 'cube': false};\r\n      }\r\n\r\n      if(BlockType.Properties){\r\n\r\n        return {\r\n          'name' : BlockType.Name.value,\r\n          'cube' : false,\r\n          'special' : BlockType.Properties.value\r\n        };\r\n\r\n      } else {\r\n\r\n        return {\r\n          'name' : BlockType.Name.value,\r\n          'cube' : true\r\n        };\r\n\r\n      }\r\n    }\r\n\r\n    function findBlock(x,y,z,data,palette){\r\n      //console.log(data[0].pos.value.value);\r\n      for(const [i, v] of data.entries()){\r\n        const BlockArray = data[i].pos.value.value;\r\n        if(BlockArray[0] == x && BlockArray[1] == y && BlockArray[2] == z){\r\n          return blockStructure(palette,data[i].state.value);\r\n        }\r\n      }\r\n\r\n    }\r\n\r\n\r\n    function parseNBT(input) {\r\n      console.log('Parsing...');\r\n\r\n      let dump = {\r\n        author: \"\",\r\n        dimension: {x:0,y:0,z:0}, \r\n        blocks: [] //blocks[x][y][z]\r\n      }\r\n\r\n      // const BlockList = input.value.blocks.value.value;\r\n      // BlockPositionArray = input.value.blocks.value.value.pos.value.value;\r\n\r\n      //Block palette:\r\n      let palette = input.value.palette.value.value;\r\n      console.log(palette);\r\n\r\n      //First Pass\r\n      for(const block of input.value.blocks.value.value){ \r\n\r\n        console.log(block);\r\n\r\n        //The [ x, y, z ] Array\r\n        var blockArray = block.pos.value.value;\r\n\r\n        if(blockArray[0] > dump.dimension.x){\r\n          dump.dimension.x = blockArray[0]; \r\n        }\r\n        //y\r\n        if(blockArray[1] > dump.dimension.y){\r\n          dump.dimension.y = blockArray[1]; \r\n        }\r\n        //z\r\n        if(blockArray[2] > dump.dimension.z){\r\n          dump.dimension.z = blockArray[2]; \r\n        }\r\n\r\n      }\r\n      dump.dimension.x++; dump.dimension.y++; dump.dimension.z++; //( +1 to each axis after loop )\r\n\r\n      console.log(dump.dimension)\r\n\r\n      //Generating 3d Array Structure: \r\n\r\n      for(let x_i = 0; x_i < dump.dimension.x; x_i++ ){\r\n\r\n        //Generate all x indexes\r\n        dump.blocks.push([]);\r\n        \r\n        //Generate all y indexes within x indexes\r\n        for(let y_i = 0; y_i < dump.dimension.y; y_i++){\r\n          dump.blocks[x_i].push([]);\r\n\r\n            //Generate z indexes within y indexes\r\n            for(let z_i = 0; z_i < dump.dimension.z; z_i++){\r\n              dump.blocks[x_i][y_i].push(\r\n              findBlock(x_i,y_i,z_i,input.value.blocks.value.value,palette)\r\n              );\r\n              console.log('generating 3d arr')\r\n            }\r\n\r\n        }\r\n\r\n        \r\n\r\n      }\r\n\r\n      console.log(' 3D structure: ')\r\n      console.log(dump.blocks)\r\n\r\n\r\n      let sceneParse = [];\r\n\r\n      //Generate planes:\r\n      for(const [xIter, xVal] of dump.blocks.entries()) {\r\n        console.log(xIter); //Console logs all x arrays\r\n        for(const [yIter,yVal] of xVal.entries()){\r\n          console.log(yIter);\r\n            for(const [zIter, zVal] of yVal.entries()){\r\n              console.log(zVal);\r\n        //This will be the logic for rendering:\r\n        \r\n        //Surrounding block coord differences: xyz 012\r\n        const surround = [ [0,1] , [0,-1] , [1,1] , [1,-1] , [2,1] , [2,-1] ];\r\n\r\n        console.log('viewing: ');\r\n        console.log(zVal.name + \"@\"+xIter+' '+yIter+' '+zIter);\r\n        \r\n        if(!zVal.name){continue;}\r\n\r\n          for(let k = 0; k < surround.length; k++){\r\n            //do something\r\n            \r\n            if(surround[k][0] == 0 ){ //Looking at x\r\n\r\n              let compare = '';\r\n              try {\r\n                compare = dump.blocks[ xIter+surround[k][1] ][yIter][zIter];\r\n              } catch(error){\r\n                console.log('Render NULL X');\r\n              }\r\n\r\n              if(!compare || compare.cube == false ){\r\n                //Render for x\r\n                // blockState.push(\r\n                //   <TexturePlane x={xIter} y={yIter} z={zIter} rot={[0, Math.PI / 2, 0]}/>\r\n                // );\r\n                // console.log('Rendering x @'+surround[k][1]+ ' x'+xIter+' y'+yIter+' z'+zIter);\r\n                sceneParse.push(\r\n                  (surround[k][1] > 0) ? \r\n                  <TexturePlane x={xIter-1} y={yIter+0.5} z={zIter} rot={[0, -Math.PI / 2, 0]}/>\r\n                  : <TexturePlane x={xIter} y={yIter+0.5} z={zIter} rot={[0, Math.PI / 2, 0]}/>\r\n                )\r\n              } \r\n            }\r\n            \r\n            if(surround[k][0] == 1){\r\n              let compare = '';\r\n              try {\r\n                compare = dump.blocks[xIter][yIter+surround[k][1]][zIter];\r\n              } catch(error){\r\n                console.log('Render NULL Y');\r\n              }\r\n\r\n              if(!compare || compare.cube == false){\r\n                sceneParse.push(\r\n                  (surround[k][1] > 0) ? \r\n                  <TexturePlane x={xIter-0.5} y={yIter+0.5} z={zIter-0.5} rot={[0,0, -Math.PI/2]}/>\r\n                  : <TexturePlane x={xIter-0.5} y={yIter+0.5} z={zIter+0.5} rot={[0, 0, Math.PI / 2]}/>\r\n                )\r\n              }\r\n\r\n            }\r\n            \r\n            if(surround[k][0] == 2){\r\n              let compare = '';\r\n              try {\r\n                compare = dump.blocks[xIter][yIter][zIter+surround[k][1]];\r\n              } catch(error){\r\n                console.log('Render NULL Z');\r\n              }\r\n\r\n              if(!compare || compare.cube == false){\r\n                sceneParse.push(\r\n                  (surround[k][1] > 0) ? \r\n                  <TexturePlane x={xIter-0.5} y={yIter+1} z={zIter} rot={[Math.PI / 2, 0, 0]}/>\r\n                  : <TexturePlane x={xIter-0.5} y={yIter} z={zIter} rot={[-Math.PI / 2, 0, 0]}/>\r\n                )\r\n              }\r\n\r\n            }\r\n\r\n\r\n\r\n          }\r\n\r\n            } // end of z loop\r\n\r\n        }\r\n\r\n      }\r\n      console.log('# of Planes:');\r\n      console.log(sceneParse.length);\r\n      console.log('\\n');\r\n      setScene(sceneParse);\r\n\r\n      // for(const block of input.value.blocks.value.value){\r\n      //   console.log(block.pos.value.value);\r\n      //   console.log(block.state.value);\r\n      // }\r\n\r\n      //setScene([<TexturePlane x={3} y={3} z={0} rot={[-Math.PI / 2, 0, 0]}/>]);\r\n\r\n\r\n\r\n    }\r\n\r\n    \r\n    function handleChange(event) {\r\n        console.log(event.target.files);\r\n        // console.log(event.target.files[0]); //file struc\r\n        const file = event.target.files[0];\r\n        var reader = new FileReader();\r\n        reader.onload = (e) => {\r\n\r\n            console.log(e.target.result);\r\n\r\n\r\n            var x = nbt.parse(e.target.result, function(error, data) {\r\n              if (error) { throw error; }\r\n          \r\n              console.log(data);\r\n              parseNBT(data);\r\n          });\r\n\r\n        }\r\n        reader.readAsArrayBuffer(file);\r\n    }\r\n\r\n\r\n  return (\r\n    <Container>\r\n    Input NBT file <br/>\r\n    <input type=\"file\" onChange={handleChange}></input>\r\n    {renderHandler()}\r\n    </Container>\r\n  )\r\n}\r\n\r\nexport default Upload"]},"metadata":{},"sourceType":"module"}